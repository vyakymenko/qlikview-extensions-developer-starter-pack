/**
 * Qvet - QlikView Extension Trickster
 *
 * @version v0.0.5
 * @author Valentyn Yakymenko <rayfesoul@gmail.com>
 * @license MIT
 */!function e(t,o,n){function i(a,u){if(!o[a]){if(!t[a]){var c="function"==typeof require&&require;if(!u&&c)return c(a,!0);if(r)return r(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var l=o[a]={exports:{}};t[a][0].call(l.exports,function(e){var o=t[a][1][e];return i(o?o:e)},l,l.exports,e,t,o,n)}return o[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.QvetCore=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=e("./native/ToolbarActions"),a=e("./development/Bookmarks"),u=e("./development/Repository"),c=e("./addition/EmailBookmark"),s=e("./addition/SelectListBoxValues"),l="0.0.5";o.QvetCore=function(){function e(){n(this,e),this["native"]={bookmarks:{$add:r.$AddBookmark,$remove:r.$RemoveBookmark,$email:r.$EmailBookmark},$openRepository:r.$OpenRepository,$showFields:r.$ShowFields,$newSheetObject:r.$NewSheetObject},this.development={bookmarks:{$add:a.$AddBookmarkQva,$remove:a.$RemoveBookmarkQva},$openRepository:u.$OpenRepositoryAjax}}return i(e,[{key:"getVersion",value:function(){return console.log("Qvet version: "+l)}},{key:"sendEmailBookmark",value:function(e,t){return new c.EmailBookmark(e,t).createBookmark().openEmailWindow()}},{key:"selectListBoxValues",value:function(e,t,o){return(0,s.SelectListBoxValues)(e,t,o)}}]),e}()},{"./addition/EmailBookmark":2,"./addition/SelectListBoxValues":3,"./development/Bookmarks":4,"./development/Repository":5,"./native/ToolbarActions":6}],2:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.EmailBookmark=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=e("../util/Util");o.EmailBookmark=function(){function e(t,o){n(this,e);var i={emailSubject:"",name:"Email Bookmark",shared:!0,excludeSelections:!1,includeState:!0,notDisplayed:!1,descriptionShow:!1,descriptionMsg:"",saveInputValues:!0};if(this.defaulQvAjxZfc="/QvAJAXZfc/opendoc.htm?document=",this.applied=!0,this.doc=Qv.GetCurrentDocument(),this.bookmarkId="",(0,r.$tv)(t,"object"))this.emailSubject=t.emailSubject||i.emailSubject,this.name=t.name||i.name,this.shared=t.shared||i.shared,this.excludeSelections=t.excludeSelections||i.excludeSelections,this.includeState=t.includeState||i.includeState,this.notDisplayed=t.notDisplayed||i.notDisplayed,this.descriptionShow=t.descriptionShow||i.descriptionShow,this.descriptionMsg=t.descriptionMsg||i.descriptionMsg,this.saveInputValues=t.saveInputValues||i.saveInputValues;else for(var a in i)i.hasOwnProperty(a)&&(this[a]=i[a]);(0,r.$tv)(o,"object")?(this.extraUri=o.extraUri||"",this.emailWindowMode=o.emailWindowMode||!0):(this.extraUri="",this.emailWindowMode=!0)}return i(e,[{key:"createBookmark",value:function(){return this.doc.Bookmarks().NewBookmark(this.name,this.applied,this.shared,this.excludeSelections,this.includeState,this.notDisplayed,this.descriptionShow,this.descriptionMsg,this.saveInputValues),this.bookmarkId=this.doc.Bookmarks().BookMarks[this.doc.Bookmarks().BookMarks.length-1].value,this}},{key:"openEmailWindow",value:function(){var e=this.extraUri+window.location.origin+this.defaulQvAjxZfc+this.doc.binder.View+"&addition="+this.bookmarkId,t=encodeURIComponent(e).replace(/%20/g,"%2520"),o="mailto:?subject="+this.emailSubject+"&body="+t;return this.emailWindowMode?window.location.href=o:location.href=o,this}}]),e}()},{"../util/Util":7}],3:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=void 0;o.SelectListBoxValues=function i(e,t,o){if(t<e.length)qva.GetQvObject(e[t].name,function(){this.callbackFn=function(){},this.Data.SelectTexts(e[t].values),t++,i(e,t,o)},n);else if(t===e.length&&"function"==typeof o)return o()}},{}],4:[function(e,t,o){"use strict";function n(){Qva.ContextClientAction({clientAction:"modal",param:"bm",name:"ADDBM",binder:Qv.GetCurrentDocument().binder})}function i(){Qva.ContextClientAction({clientAction:"modal",param:"removebm",name:"REMBM",binder:Qv.GetCurrentDocument().binder})}Object.defineProperty(o,"__esModule",{value:!0}),o.$AddBookmarkQva=n,o.$RemoveBookmarkQva=i},{}],5:[function(e,t,o){"use strict";function n(e,t){var o=Qv.GetCurrentDocument().binder,n=o.Mark,i=o.Stamp,r=o.View,a=e>3&&0>e?0:e,u='<update\n	        mark="'+n+'"\n	        stamp="'+i+'"\n	        cookie="true"\n	        scope="Document"\n	        view="'+r+'"\n	        ident="null">\n	            <set name="Document.StandardActions.REPOSITORY" action="" clientsizeWH="" position="" cursor="" />\n	        </update>',c='<update\n	        mark="'+n+'"\n	        stamp="'+i+'"\n	        cookie="true"\n	        scope="Document"\n	        view="'+r+'"\n	        ident="null">\n	            <set name="Document.TOOLS\\REPOSITORY.Filter"\n	            value="'+a+'" />\n	        </update>',s=function(){return new Promise(function(e,t){$.ajax({url:"/QvAjaxZfc/QvsViewClient.aspx?mark="+n+"&view="+r,data:u,type:"POST",contentType:"text/plain;charset=UTF-8",dataType:"text",success:function(){e()},error:function(){t()}})})},l=function(){return new Promise(function(e,t){$.ajax({url:"/QvAjaxZfc/QvsViewClient.aspx?mark="+n+"&view="+r,data:c,type:"POST",contentType:"text/plain;charset=UTF-8",dataType:"text",success:function(){e()},error:function(){t()}})})};Promise.all([s(),l()]).then(function(){return"function"==typeof t?t():void 0})}Object.defineProperty(o,"__esModule",{value:!0}),o.$OpenRepositoryAjax=n},{}],6:[function(e,t,o){"use strict";function n(){(0,s.$QvaToolbarAction)("ADDBM")}function i(){(0,s.$QvaToolbarAction)("REMBM")}function r(){(0,s.$QvaToolbarAction)("MAILASLINK")}function a(){(0,s.$QvaToolbarAction)("NEWSHEETOBJ")}function u(){(0,s.$QvaToolbarAction)("REPOSITORY")}function c(){(0,s.$QvaToolbarAction)("SHOWFIELDS")}Object.defineProperty(o,"__esModule",{value:!0}),o.$AddBookmark=n,o.$RemoveBookmark=i,o.$EmailBookmark=r,o.$NewSheetObject=a,o.$OpenRepository=u,o.$ShowFields=c;var s=e("../util/Util")},{"../util/Util":7}],7:[function(e,t,o){"use strict";function n(e,t){return("undefined"==typeof e?"undefined":r(e))===t}function i(e){Qva.Mgr.menu.doAction({target:".ctx-menu-action-"+e})}Object.defineProperty(o,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};o.$tv=n,o.$QvaToolbarAction=i},{}],8:[function(e,t,o){"use strict";var n=e("./core/Core");!function(e){"undefined"==typeof Qva&&"undefined"==typeof jQuery&&"undefined"==typeof qva?console.log("Can't init Qvet because Qva/jQuery/qva is undefined"):"undefined"==typeof Qvet?e.Qvet=new n.QvetCore:console.log("Qvet already defined.")}(window)},{"./core/Core":1}]},{},[8]);